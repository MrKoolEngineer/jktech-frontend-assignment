#!/bin/sh

# Get staged files
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.(js|ts|tsx)$')

if [ -z "$STAGED_FILES" ]; then
  echo "âœ… No relevant staged files. Skipping lint and tests."
  exit 0
fi

echo "ğŸ” Running lint on staged files..."
npx eslint $STAGED_FILES || {
  echo "âŒ Lint failed. Please fix errors before pushing.";
  exit 1;
}

echo "ğŸ§ª Running tests..."
npx jest --ci --runInBand --maxWorkers=2 || {
  echo "âŒ Tests failed. Fix them before pushing.";
  exit 1;
}

echo "âœ… All checks passed. Push allowed!"
